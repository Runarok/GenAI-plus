<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brightness Gradient Image Editor</title>
    <link rel="icon" href="https://raw.githubusercontent.com/Runarok/GenAI-plus/main/GenAI-plus.png" type="image/png">
    <style>
        :root {
            --primary-color: #2196F3;
            --primary-hover: #1976D2;
            --primary-active: #1565C0;
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --border-color: #404040;
            --success-color: #4CAF50;
            --error-color: #f44336;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.6);
        }

        /* Light Theme */
        [data-theme="light"] {
            --primary-color: #2196F3;
            --primary-hover: #1976D2;
            --primary-active: #1565C0;
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --text-primary: #212121;
            --text-secondary: #757575;
            --border-color: #e0e0e0;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        /* Dark Theme (Default) */
        [data-theme="dark"] {
            --primary-color: #2196F3;
            --primary-hover: #1976D2;
            --primary-active: #1565C0;
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --border-color: #404040;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.6);
        }

        /* Neon Theme */
        [data-theme="neon"] {
            --primary-color: #00ff00;
            --primary-hover: #00cc00;
            --primary-active: #009900;
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --text-primary: #00ff00;
            --text-secondary: #00aa00;
            --border-color: #00ff00;
            --success-color: #00ff00;
            --error-color: #ff0000;
            --shadow: 0 2px 8px rgba(0, 255, 0, 0.2);
            --shadow-lg: 0 8px 24px rgba(0, 255, 0, 0.3);
        }

        /* Sunset Theme */
        [data-theme="sunset"] {
            --primary-color: #FF6B6B;
            --primary-hover: #EE5A52;
            --primary-active: #C44444;
            --bg-primary: #1a0f0a;
            --bg-secondary: #2d1810;
            --text-primary: #FFD9D0;
            --text-secondary: #D4A574;
            --border-color: #804020;
            --success-color: #FFB347;
            --error-color: #FF6B6B;
            --shadow: 0 2px 8px rgba(255, 107, 107, 0.2);
            --shadow-lg: 0 8px 24px rgba(255, 107, 107, 0.3);
        }

        /* Ocean Theme */
        [data-theme="ocean"] {
            --primary-color: #00D4FF;
            --primary-hover: #00B8D4;
            --primary-active: #0099CC;
            --bg-primary: #0a1620;
            --bg-secondary: #112840;
            --text-primary: #B0E8FF;
            --text-secondary: #4FA3D1;
            --border-color: #1E5F8B;
            --success-color: #00FF88;
            --error-color: #FF4444;
            --shadow: 0 2px 8px rgba(0, 212, 255, 0.2);
            --shadow-lg: 0 8px 24px rgba(0, 212, 255, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        body {
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 32px;
            text-align: center;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        .section {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 24px;
            box-shadow: var(--shadow);
            transition: box-shadow 0.2s ease;
        }

        .section:hover {
            box-shadow: var(--shadow-lg);
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .icon {
            font-size: 1.2rem;
        }

        /* Drop Zone */
        .drop-zone {
            border: 3px dashed var(--border-color);
            border-radius: 8px;
            padding: 48px 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.02) 0%, rgba(33, 150, 243, 0.05) 100%);
            margin-bottom: 16px;
        }

        .drop-zone:hover {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.05) 0%, rgba(33, 150, 243, 0.1) 100%);
        }

        .drop-zone.drag-over {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1) 0%, rgba(33, 150, 243, 0.15) 100%);
            transform: scale(1.02);
        }

        .drop-zone-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            display: block;
            color: var(--primary-color);
        }

        .drop-zone-text {
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 4px;
        }

        .drop-zone-subtext {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        #fileInput {
            display: none;
        }

        /* Canvas */
        .canvas-wrapper {
            position: relative;
            background: #f9f9f9;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 450px;
            margin-bottom: 16px;
        }

        /* Presets Section */
        .presets-container {
            width: 100%;
        }

        .presets-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .presets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 8px;
            margin-bottom: 20px;
        }

        .preset-btn {
            padding: 10px 12px;
            background: var(--border-color);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .preset-btn:active {
            transform: translateY(0);
        }

        /* Coordinate Inputs */
        .coords-input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 12px;
        }

        .coord-input-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .coord-input-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .coord-input {
            display: flex;
            gap: 4px;
        }

        .coord-input input {
            flex: 1;
            padding: 6px 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.8rem;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .coord-input input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 4px rgba(33, 150, 243, 0.3);
        }

        .coord-input-percent {
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            padding: 0 4px;
        }

        /* Coordinates Display */
        .coordinates-container {
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .coords-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .coords-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .coord-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding: 10px;
            background: rgba(33, 150, 243, 0.05);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .coord-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .coord-value {
            font-size: 0.9rem;
            color: var(--primary-color);
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        canvas {
            display: block;
            border-radius: 4px;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .gradient-line {
            position: absolute;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.8) 50%, transparent 100%);
            cursor: row-resize;
            z-index: 10;
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.3);
        }

        .gradient-line.dragging {
            background: linear-gradient(90deg, transparent 0%, rgba(76, 175, 80, 0.9) 50%, transparent 100%);
            height: 4px;
        }

        .gradient-point {
            position: absolute;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 3px solid white;
            cursor: grab;
            z-index: 11;
            transform: translate(-50%, -50%);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            transition: transform 0.2s ease;
        }

        .gradient-point:hover {
            transform: translate(-50%, -50%) scale(1.2);
        }

        .gradient-point.dragging {
            cursor: grabbing;
            transform: translate(-50%, -50%) scale(1.35);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.6);
        }

        .gradient-point.top {
            background: rgba(33, 150, 243, 0.95);
        }

        .gradient-point.bottom {
            background: rgba(76, 175, 80, 0.95);
        }

        .canvas-placeholder {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-align: center;
            padding: 20px;
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.5);
        }

        /* Controls */
        .controls-section {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 24px;
            box-shadow: var(--shadow);
        }

        .control-group {
            margin-bottom: 24px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .control-label-text {
            color: var(--text-primary);
        }

        .control-value {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.95rem;
            background: rgba(33, 150, 243, 0.1);
            padding: 4px 10px;
            border-radius: 4px;
            min-width: 50px;
            text-align: center;
            border: 1px solid var(--border-color);
            cursor: text;
            transition: all 0.2s ease;
        }

        .control-value:hover {
            background: rgba(33, 150, 243, 0.2);
            border-color: var(--primary-color);
        }

        .control-value.editing {
            background: var(--bg-primary);
            border-color: var(--primary-color);
            padding: 2px 8px;
        }

        .control-value input {
            width: 100%;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: none;
            outline: none;
            font-weight: 600;
            font-size: 0.95rem;
            text-align: center;
            font-family: inherit;
        }

        .slider-container {
            position: relative;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: linear-gradient(to right, var(--border-color) 0%, var(--border-color) 100%);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(33, 150, 243, 0.3);
            transition: all 0.2s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }

        input[type="range"]::-webkit-slider-thumb:active {
            transform: scale(1.25);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(33, 150, 243, 0.3);
            transition: all 0.2s ease;
        }

        input[type="range"]::-moz-range-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }

        input[type="range"]::-moz-range-thumb:active {
            transform: scale(1.25);
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        button {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }

        .btn-primary:active:not(:disabled) {
            background: var(--primary-active);
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .btn-secondary:hover:not(:disabled) {
            background: #d0d0d0;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        /* Status Messages */
        .status-message {
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 16px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .status-message.show {
            display: block;
        }

        .status-message.error {
            background: rgba(244, 67, 54, 0.1);
            color: var(--error-color);
            border-left: 4px solid var(--error-color);
        }

        .status-message.success {
            background: rgba(76, 175, 80, 0.1);
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }

        .status-message.info {
            background: rgba(33, 150, 243, 0.1);
            color: var(--primary-color);
            border-left: 4px solid var(--primary-color);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Image Info */
        .image-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            padding: 12px;
            background: rgba(33, 150, 243, 0.05);
            border-radius: 6px;
            font-size: 0.85rem;
            margin-bottom: 16px;
            display: none;
        }

        .image-info.show {
            display: grid;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
        }

        .info-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .info-value {
            color: var(--text-primary);
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Loading State */
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(33, 150, 243, 0.3);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Theme Selector */
        .theme-selector {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 24px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .theme-btn {
            padding: 10px 16px;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .theme-btn:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .theme-btn.active {
            background: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            h1 {
                font-size: 1.5rem;
            }

            .main-layout {
                gap: 16px;
            }

            .section, .controls-section {
                padding: 16px;
            }

            button {
                min-width: 100px;
                padding: 10px 16px;
                font-size: 0.85rem;
            }

            .button-group {
                gap: 8px;
            }

            .canvas-wrapper {
                min-height: 250px;
            }

            .theme-selector {
                top: 10px;
                right: 10px;
                gap: 4px;
            }

            .theme-btn {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚ú® Brightness Gradient Image Editor</h1>
            <p class="subtitle">Upload an image, apply a smooth brightness gradient, and download the result v7.0</p>
        </header>

        <div class="main-layout">
            <!-- Upload Section -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">üì§</span>
                    <span>Upload Image</span>
                </div>
                
                <div id="statusMessage" class="status-message"></div>

                <div id="dropZone" class="drop-zone">
                    <span class="drop-zone-icon">üìÅ</span>
                    <div class="drop-zone-text">Drag & Drop your image here</div>
                    <div class="drop-zone-subtext">or click to browse</div>
                </div>

                <div id="imageInfo" class="image-info">
                    <div class="info-item">
                        <span class="info-label">Dimensions:</span>
                        <span class="info-value" id="infoDimensions">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">File Size:</span>
                        <span class="info-value" id="infoFileSize">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Format:</span>
                        <span class="info-value" id="infoFormat">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Aspect Ratio:</span>
                        <span class="info-value" id="infoRatio">-</span>
                    </div>
                </div>

                <input type="file" id="fileInput" accept="image/png,image/jpeg,image/webp,.png,.jpg,.jpeg,.webp" />

                <button class="btn-primary" id="resetBtn" disabled>
                    <span>üîÑ</span> Reset to Original
                </button>
            </div>

            <!-- Canvas Display -->
            <div class="section">
                <div class="section-title">
                    <span class="icon">üé®</span>
                    <span>Preview</span>
                </div>
                <div class="canvas-wrapper" id="canvasWrapper">
                    <canvas id="canvas"></canvas>
                    <div class="gradient-point top" id="topPoint" style="left: 20%; top: 15%;"></div>
                    <div class="gradient-point bottom" id="bottomPoint" style="left: 80%; top: 85%;"></div>
                    <div class="canvas-placeholder" id="canvasPlaceholder">
                        üì∏ Canvas will appear here
                    </div>
                </div>
                
            </div>

            <!-- Presets Section -->
            <div class="section">
                <div class="presets-container">
                    <div class="presets-title">‚ú® Quick Presets</div>
                    <div class="presets-grid">
                        <button class="preset-btn" data-preset="diagonal-tl-br">Diagonal ‚Üô ‚Üó</button>
                        <button class="preset-btn" data-preset="diagonal-bl-tr">Diagonal ‚Üñ ‚Üò</button>
                        <button class="preset-btn" data-preset="horizontal">Horizontal ‚Üê ‚Üí</button>
                        <button class="preset-btn" data-preset="vertical">Vertical ‚Üë ‚Üì</button>
                        <button class="preset-btn" data-preset="radial-center">Radial Center ‚äö</button>
                        <button class="preset-btn" data-preset="corner-tl">Corner ‚Üñ ‚Üò</button>
                    </div>

                    <!-- Coordinates Display -->
                    <div class="coordinates-container">
                        <div class="coords-title">üéØ Dot Positions</div>
                        <div class="coords-grid">
                            <div class="coord-item">
                                <span class="coord-label">üîµ Blue Dot</span>
                                <span class="coord-value" id="blueDotCoords">X: 20%, Y: 15%</span>
                            </div>
                            <div class="coord-item">
                                <span class="coord-label">üü¢ Green Dot</span>
                                <span class="coord-value" id="greenDotCoords">X: 80%, Y: 85%</span>
                            </div>
                        </div>

                        <!-- Editable Coordinates -->
                        <div class="coords-input-grid">
                            <div class="coord-input-group">
                                <span class="coord-input-label">üîµ Blue Dot</span>
                                <div class="coord-input">
                                    <input type="number" id="blueX" min="0" max="100" value="20" />
                                    <span class="coord-input-percent">%</span>
                                    <input type="number" id="blueY" min="0" max="100" value="15" />
                                    <span class="coord-input-percent">%</span>
                                </div>
                            </div>
                            <div class="coord-input-group">
                                <span class="coord-input-label">üü¢ Green Dot</span>
                                <div class="coord-input">
                                    <input type="number" id="greenX" min="0" max="100" value="80" />
                                    <span class="coord-input-percent">%</span>
                                    <input type="number" id="greenY" min="0" max="100" value="85" />
                                    <span class="coord-input-percent">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controls Section -->
        <div class="controls-section">
            <div class="section-title">
                <span class="icon">üéõÔ∏è</span>
                <span>Brightness Gradient Controls</span>
            </div>

            <div class="control-group">
                <div class="control-label">
                    <span class="control-label-text">üîµ Blue Dot Brightness</span>
                    <span class="control-value" id="topBrightnessValue" data-input="topBrightness">0</span>
                </div>
                <div class="slider-container">
                    <input type="range" id="topBrightness" min="-100" max="100" value="0" disabled />
                </div>
            </div>

            <div class="control-group">
                <div class="control-label">
                    <span class="control-label-text">üü¢ Green Dot Brightness</span>
                    <span class="control-value" id="bottomBrightnessValue" data-input="bottomBrightness">0</span>
                </div>
                <div class="slider-container">
                    <input type="range" id="bottomBrightness" min="-100" max="100" value="0" disabled />
                </div>
            </div>

            <div class="button-group">
                <button class="btn-success" id="downloadBtn" disabled>
                    <span>üíæ</span> Download as PNG
                </button>
            </div>
        </div>

        <!-- Theme Selector -->
        <div class="theme-selector">
            <button class="theme-btn active" data-theme="dark" title="Dark Theme">üåô Dark</button>
            <button class="theme-btn" data-theme="light" title="Light Theme">‚òÄÔ∏è Light</button>
            <button class="theme-btn" data-theme="neon" title="Neon Theme">‚ö° Neon</button>
            <button class="theme-btn" data-theme="sunset" title="Sunset Theme">üåÖ Sunset</button>
            <button class="theme-btn" data-theme="ocean" title="Ocean Theme">üåä Ocean</button>
        </div>

        <footer>
            <p>Built with ‚ù§Ô∏è ‚Ä¢ Brightness Gradient Image Editor v7.0</p>
        </footer>
    </div>

    <script>
        // State Management
        const state = {
            originalImage: null,
            originalImageData: null,
            canvas: document.getElementById('canvas'),
            ctx: null,
            isImageLoaded: false,
            topBrightness: 0,
            bottomBrightness: 0,
            gradientTopPercentX: 20,
            gradientTopPercentY: 15,
            gradientBottomPercentX: 80,
            gradientBottomPercentY: 85,
            isDraggingTop: false,
            isDraggingBottom: false,
            isRadialMode: false
        };

        // DOM Elements
        const elements = {
            dropZone: document.getElementById('dropZone'),
            fileInput: document.getElementById('fileInput'),
            canvas: document.getElementById('canvas'),
            canvasWrapper: document.getElementById('canvasWrapper'),
            canvasPlaceholder: document.getElementById('canvasPlaceholder'),
            statusMessage: document.getElementById('statusMessage'),
            imageInfo: document.getElementById('imageInfo'),
            topBrightness: document.getElementById('topBrightness'),
            bottomBrightness: document.getElementById('bottomBrightness'),
            topBrightnessValue: document.getElementById('topBrightnessValue'),
            bottomBrightnessValue: document.getElementById('bottomBrightnessValue'),
            topPoint: document.getElementById('topPoint'),
            bottomPoint: document.getElementById('bottomPoint'),
            resetBtn: document.getElementById('resetBtn'),
            downloadBtn: document.getElementById('downloadBtn')
        };

        // Initialize Canvas Context
        state.ctx = state.canvas.getContext('2d', { willReadFrequently: true });

        // Utility: Show Status Message
        function showStatus(message, type = 'info') {
            elements.statusMessage.textContent = message;
            elements.statusMessage.className = `status-message show ${type}`;
            setTimeout(() => {
                elements.statusMessage.classList.remove('show');
            }, 4000);
        }

        // Utility: Validate File
        function isValidImage(file) {
            const validTypes = ['image/png', 'image/jpeg', 'image/webp'];
            return file && validTypes.includes(file.type) && file.size > 0;
        }

        // Utility: Format File Size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
        }

        // Utility: Calculate Aspect Ratio String
        function getAspectRatioString(width, height) {
            const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
            const divisor = gcd(width, height);
            return `${width / divisor}:${height / divisor}`;
        }

        // Load Image and Display
        function loadImage(file) {
            if (!isValidImage(file)) {
                showStatus('Please upload a valid image (PNG, JPG, or WebP)', 'error');
                return;
            }

            const reader = new FileReader();

            reader.onload = (e) => {
                try {
                    const img = new Image();

                    img.onload = () => {
                        try {
                            // Reset brightness values
                            state.topBrightness = 0;
                            state.bottomBrightness = 0;
                            elements.topBrightness.value = 0;
                            elements.bottomBrightness.value = 0;
                            elements.topBrightnessValue.textContent = '0';
                            elements.bottomBrightnessValue.textContent = '0';

                            // Set canvas dimensions to match image
                            state.canvas.width = img.width;
                            state.canvas.height = img.height;

                            // Store original image
                            state.originalImage = img;
                            state.isImageLoaded = true;

                            // Draw original image to canvas
                            state.ctx.drawImage(img, 0, 0);

                            // Store original image data
                            state.originalImageData = state.ctx.getImageData(0, 0, state.canvas.width, state.canvas.height);

                            // Show canvas and hide placeholder
                            state.canvas.style.display = 'block';
                            elements.canvasPlaceholder.style.display = 'none';

                            // Show gradient points
                            elements.topPoint.style.display = 'block';
                            elements.bottomPoint.style.display = 'block';

                            // Enable controls
                            elements.topBrightness.disabled = false;
                            elements.bottomBrightness.disabled = false;
                            elements.resetBtn.disabled = false;
                            elements.downloadBtn.disabled = false;

                            // Update image info
                            updateImageInfo(img.width, img.height, file.size, file.type);

                            // Show success message
                            showStatus('‚úÖ Image loaded successfully!', 'success');
                        } catch (error) {
                            console.error('Error processing image:', error);
                            showStatus('Error processing image. Please try again.', 'error');
                        }
                    };

                    img.onerror = () => {
                        showStatus('Failed to load image. Please try a different file.', 'error');
                    };

                    img.src = e.target.result;
                } catch (error) {
                    console.error('Error reading file:', error);
                    showStatus('Error reading file. Please try again.', 'error');
                }
            };

            reader.onerror = () => {
                showStatus('Error reading file. Please try again.', 'error');
            };

            reader.readAsDataURL(file);
        }

        // Update Image Info Display
        function updateImageInfo(width, height, fileSize, fileType) {
            document.getElementById('infoDimensions').textContent = `${width} √ó ${height}px`;
            document.getElementById('infoFileSize').textContent = formatFileSize(fileSize);
            document.getElementById('infoFormat').textContent = fileType.split('/')[1].toUpperCase();
            document.getElementById('infoRatio').textContent = getAspectRatioString(width, height);
            elements.imageInfo.classList.add('show');
        }

        // Apply Brightness Gradient with Freeform Points
        function applyBrightnessGradient() {
            if (!state.isImageLoaded || !state.originalImageData) return;

            try {
                // Create a copy of original image data
                const imageData = state.ctx.createImageData(state.originalImageData);
                const data = imageData.data;
                const originalData = state.originalImageData.data;

                const width = state.canvas.width;
                const height = state.canvas.height;

                // Convert percentages to pixel coordinates
                const topX = (state.gradientTopPercentX / 100) * width;
                const topY = (state.gradientTopPercentY / 100) * height;
                const bottomX = (state.gradientBottomPercentX / 100) * width;
                const bottomY = (state.gradientBottomPercentY / 100) * height;

                // Process each pixel
                for (let i = 0; i < originalData.length; i += 4) {
                    const pixelIndex = i / 4;
                    const pixelY = Math.floor(pixelIndex / width);
                    const pixelX = pixelIndex % width;

                    let gradientProgress = 0;

                    if (state.isRadialMode) {
                        // Radial gradient: distance from center to edge
                        const dX = bottomX - topX;
                        const dY = bottomY - topY;
                        const maxRadius = Math.sqrt(dX * dX + dY * dY);

                        if (maxRadius > 0) {
                            const pixelDX = pixelX - topX;
                            const pixelDY = pixelY - topY;
                            const pixelDistance = Math.sqrt(pixelDX * pixelDX + pixelDY * pixelDY);
                            gradientProgress = Math.max(0, Math.min(1, pixelDistance / maxRadius));
                        }
                    } else {
                        // Linear gradient: dot product projection onto gradient line
                        const dX = bottomX - topX;
                        const dY = bottomY - topY;
                        const distSquared = dX * dX + dY * dY;

                        if (distSquared > 0) {
                            const dotProduct = (pixelX - topX) * dX + (pixelY - topY) * dY;
                            gradientProgress = Math.max(0, Math.min(1, dotProduct / distSquared));
                        }
                    }

                    // Linear interpolation of brightness values
                    const brightness = state.topBrightness + (state.bottomBrightness - state.topBrightness) * gradientProgress;

                    // Apply brightness adjustment (scale: -100 to +100)
                    const factor = 1 + brightness / 100;

                    // Get original RGB values
                    const r = originalData[i];
                    const g = originalData[i + 1];
                    const b = originalData[i + 2];
                    const a = originalData[i + 3];

                    // Apply brightness and clamp to 0-255
                    data[i] = Math.max(0, Math.min(255, Math.round(r * factor)));
                    data[i + 1] = Math.max(0, Math.min(255, Math.round(g * factor)));
                    data[i + 2] = Math.max(0, Math.min(255, Math.round(b * factor)));
                    data[i + 3] = a;
                }

                // Put modified image data back on canvas
                state.ctx.putImageData(imageData, 0, 0);
            } catch (error) {
                console.error('Error applying brightness gradient:', error);
                showStatus('Error applying effect. Please try again.', 'error');
            }
        }

        // Reset to Original Image
        function resetImage() {
            if (!state.originalImage) return;

            try {
                state.topBrightness = 0;
                state.bottomBrightness = 0;
                elements.topBrightness.value = 0;
                elements.bottomBrightness.value = 0;
                elements.topBrightnessValue.textContent = '0';
                elements.bottomBrightnessValue.textContent = '0';

                // Redraw original
                state.ctx.drawImage(state.originalImage, 0, 0);
                state.originalImageData = state.ctx.getImageData(0, 0, state.canvas.width, state.canvas.height);

                showStatus('üîÑ Reset to original image', 'success');
            } catch (error) {
                console.error('Error resetting image:', error);
                showStatus('Error resetting image.', 'error');
            }
        }

        // Download Image as PNG
        function downloadImage() {
            if (!state.isImageLoaded) {
                showStatus('No image to download', 'error');
                return;
            }

            try {
                const link = document.createElement('a');
                link.href = state.canvas.toDataURL('image/png');
                link.download = `brightness-gradient-${new Date().getTime()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showStatus('üíæ Image downloaded successfully!', 'success');
            } catch (error) {
                console.error('Error downloading image:', error);
                showStatus('Error downloading image. Please try again.', 'error');
            }
        }

        // Event Listeners: Drop Zone
        elements.dropZone.addEventListener('click', () => {
            elements.fileInput.click();
        });

        elements.dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
            elements.dropZone.classList.add('drag-over');
        });

        elements.dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            e.stopPropagation();
            elements.dropZone.classList.remove('drag-over');
        });

        elements.dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();
            elements.dropZone.classList.remove('drag-over');

            const files = e.dataTransfer.files;
            if (files.length > 0) {
                loadImage(files[0]);
            }
        });

        // Event Listeners: File Input
        elements.fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                loadImage(e.target.files[0]);
            }
        });

        // Event Listeners: Brightness Sliders
        elements.topBrightness.addEventListener('input', (e) => {
            state.topBrightness = parseInt(e.target.value);
            elements.topBrightnessValue.textContent = state.topBrightness;
            applyBrightnessGradient();
        });

        elements.bottomBrightness.addEventListener('input', (e) => {
            state.bottomBrightness = parseInt(e.target.value);
            elements.bottomBrightnessValue.textContent = state.bottomBrightness;
            applyBrightnessGradient();
        });

        // Gradient Point Dragging - Freeform Movement
        function startDragging(isTop) {
            return (e) => {
                e.preventDefault();
                if (isTop) {
                    state.isDraggingTop = true;
                    elements.topPoint.classList.add('dragging');
                } else {
                    state.isDraggingBottom = true;
                    elements.bottomPoint.classList.add('dragging');
                }
            };
        }

        function handleMouseMove(e) {
            const wrapper = elements.canvasWrapper;
            const rect = wrapper.getBoundingClientRect();
            const x = e.clientY - rect.top;
            const y = e.clientY - rect.top;
            const percentX = Math.max(0, Math.min(100, ((e.clientX - rect.left) / rect.width) * 100));
            const percentY = Math.max(0, Math.min(100, (y / rect.height) * 100));

            if (state.isDraggingTop) {
                state.gradientTopPercentX = percentX;
                state.gradientTopPercentY = percentY;
                elements.topPoint.style.left = percentX + '%';
                elements.topPoint.style.top = percentY + '%';
                updateCoordinatesDisplay();
                applyBrightnessGradient();
            }

            if (state.isDraggingBottom) {
                state.gradientBottomPercentX = percentX;
                state.gradientBottomPercentY = percentY;
                elements.bottomPoint.style.left = percentX + '%';
                elements.bottomPoint.style.top = percentY + '%';
                updateCoordinatesDisplay();
                applyBrightnessGradient();
            }
        }

        function stopDragging() {
            state.isDraggingTop = false;
            state.isDraggingBottom = false;
            elements.topPoint.classList.remove('dragging');
            elements.bottomPoint.classList.remove('dragging');
            state.isRadialMode = false;
            updateCoordinatesDisplay();
        }

        // Update Coordinates Display
        function updateCoordinatesDisplay() {
            const topX = Math.round(state.gradientTopPercentX * 10) / 10;
            const topY = Math.round(state.gradientTopPercentY * 10) / 10;
            const bottomX = Math.round(state.gradientBottomPercentX * 10) / 10;
            const bottomY = Math.round(state.gradientBottomPercentY * 10) / 10;

            document.getElementById('blueDotCoords').textContent = `X: ${topX}%, Y: ${topY}%`;
            document.getElementById('greenDotCoords').textContent = `X: ${bottomX}%, Y: ${bottomY}%`;
        }

        // Apply Preset
        function applyPreset(presetName) {
            const presets = {
                'diagonal-tl-br': { topX: 5, topY: 5, bottomX: 95, bottomY: 95, isRadial: false },
                'diagonal-bl-tr': { topX: 5, topY: 95, bottomX: 95, bottomY: 5, isRadial: false },
                'horizontal': { topX: 0, topY: 50, bottomX: 100, bottomY: 50, isRadial: false },
                'vertical': { topX: 50, topY: 0, bottomX: 50, bottomY: 100, isRadial: false },
                'radial-center': { topX: 50, topY: 50, bottomX: 80, bottomY: 50, isRadial: true },
                'corner-tl': { topX: 0, topY: 0, bottomX: 100, bottomY: 100, isRadial: false }
            };

            const preset = presets[presetName];
            if (preset) {
                state.isRadialMode = preset.isRadial;
                state.gradientTopPercentX = preset.topX;
                state.gradientTopPercentY = preset.topY;
                state.gradientBottomPercentX = preset.bottomX;
                state.gradientBottomPercentY = preset.bottomY;

                elements.topPoint.style.left = preset.topX + '%';
                elements.topPoint.style.top = preset.topY + '%';
                elements.bottomPoint.style.left = preset.bottomX + '%';
                elements.bottomPoint.style.top = preset.bottomY + '%';

                // Update input fields
                document.getElementById('blueX').value = Math.round(preset.topX);
                document.getElementById('blueY').value = Math.round(preset.topY);
                document.getElementById('greenX').value = Math.round(preset.bottomX);
                document.getElementById('greenY').value = Math.round(preset.bottomY);

                updateCoordinatesDisplay();
                if (state.isImageLoaded) {
                    applyBrightnessGradient();
                }
                showStatus(`‚ú® Applied preset`, 'success');
            }
        }

        // Update dots from coordinate inputs
        function updateDotsFromInputs() {
            if (!state.isImageLoaded) {
                showStatus('Please load an image first', 'error');
                return;
            }

            let blueX = parseFloat(document.getElementById('blueX').value) || 0;
            let blueY = parseFloat(document.getElementById('blueY').value) || 0;
            let greenX = parseFloat(document.getElementById('greenX').value) || 0;
            let greenY = parseFloat(document.getElementById('greenY').value) || 0;

            blueX = Math.max(0, Math.min(100, blueX));
            blueY = Math.max(0, Math.min(100, blueY));
            greenX = Math.max(0, Math.min(100, greenX));
            greenY = Math.max(0, Math.min(100, greenY));

            state.gradientTopPercentX = blueX;
            state.gradientTopPercentY = blueY;
            state.gradientBottomPercentX = greenX;
            state.gradientBottomPercentY = greenY;
            state.isRadialMode = false;

            elements.topPoint.style.left = blueX + '%';
            elements.topPoint.style.top = blueY + '%';
            elements.bottomPoint.style.left = greenX + '%';
            elements.bottomPoint.style.top = greenY + '%';

            document.getElementById('blueX').value = blueX;
            document.getElementById('blueY').value = blueY;
            document.getElementById('greenX').value = greenX;
            document.getElementById('greenY').value = greenY;

            updateCoordinatesDisplay();
            applyBrightnessGradient();
        }

        // Event Listeners: Gradient Points
        elements.topPoint.addEventListener('mousedown', startDragging(true));
        elements.bottomPoint.addEventListener('mousedown', startDragging(false));
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', stopDragging);

        // Touch Support for Gradient Points
        elements.topPoint.addEventListener('touchstart', startDragging(true));
        elements.bottomPoint.addEventListener('touchstart', startDragging(false));
        document.addEventListener('touchmove', (e) => {
            if (state.isDraggingTop || state.isDraggingBottom) {
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousemove', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                handleMouseMove(mouseEvent);
            }
        }, { passive: false });
        document.addEventListener('touchend', stopDragging);

        // Editable Value Input System
        function makeValueEditable(valueElement) {
            valueElement.addEventListener('click', () => {
                if (valueElement.classList.contains('editing')) return;

                const inputId = valueElement.dataset.input;
                const currentValue = valueElement.textContent;

                valueElement.classList.add('editing');
                const input = document.createElement('input');
                input.type = 'number';
                input.value = currentValue;
                input.min = '-100';
                input.max = '100';

                valueElement.textContent = '';
                valueElement.appendChild(input);
                input.focus();
                input.select();

                function saveValue() {
                    let newValue = parseInt(input.value) || 0;
                    newValue = Math.max(-100, Math.min(100, newValue));

                    elements[inputId].value = newValue;
                    elements[inputId].dispatchEvent(new Event('input'));

                    valueElement.classList.remove('editing');
                    valueElement.textContent = newValue;
                }

                input.addEventListener('blur', saveValue);
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') saveValue();
                    if (e.key === 'Escape') {
                        valueElement.classList.remove('editing');
                        valueElement.textContent = currentValue;
                    }
                });
            });
        }

        // Initialize editable values
        makeValueEditable(elements.topBrightnessValue);
        makeValueEditable(elements.bottomBrightnessValue);

        // Theme Selector
        const themeButtons = document.querySelectorAll('.theme-btn');
        const htmlElement = document.documentElement;

        // Set default theme to dark
        htmlElement.setAttribute('data-theme', 'dark');

        themeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const theme = btn.dataset.theme;
                htmlElement.setAttribute('data-theme', theme);
                localStorage.setItem('editorTheme', theme);

                // Update active button
                themeButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        // Load saved theme or default to dark
        const savedTheme = localStorage.getItem('editorTheme') || 'dark';
        htmlElement.setAttribute('data-theme', savedTheme);
        themeButtons.forEach(btn => {
            if (btn.dataset.theme === savedTheme) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        // Event Listeners: Preset Buttons
        document.addEventListener('DOMContentLoaded', () => {
            const presetButtons = document.querySelectorAll('.preset-btn');
            presetButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (!state.isImageLoaded) {
                        showStatus('Please load an image first', 'error');
                        return;
                    }
                    const presetName = btn.getAttribute('data-preset');
                    applyPreset(presetName);
                });
            });
        });

        // Event Listeners: Coordinate Inputs
        const coordInputs = ['blueX', 'blueY', 'greenX', 'greenY'];
        coordInputs.forEach(id => {
            document.getElementById(id).addEventListener('change', updateDotsFromInputs);
            document.getElementById(id).addEventListener('input', updateDotsFromInputs);
        });

        // Event Listeners: Buttons
        elements.resetBtn.addEventListener('click', resetImage);
        elements.downloadBtn.addEventListener('click', downloadImage);

        // Initial coordinates display
        updateCoordinatesDisplay();

        // Prevent default drag and drop behavior on document
        document.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
        });

        document.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();
        });

        // Initial placeholder display
        state.canvas.style.display = 'none';
        elements.topPoint.style.display = 'none';
        elements.bottomPoint.style.display = 'none';
    </script>
</body>
</html>
