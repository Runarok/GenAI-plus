<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HTML Link Tag Fixer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #fafbfc;
    }
    .container {
      display: flex;
      height: 100vh;
      min-height: 400px;
    }
    .pane {
      flex: 1;
      padding: 2rem;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      background: #fff;
    }
    .pane.left {
      border-right: 1px solid #ececec;
      background: #f7f9fa;
    }
    .pane.right {
      background: #fff;
    }
    .pane label {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #2b2f33;
    }
    .pane textarea {
      flex: 1;
      width: 100%;
      min-height: 120px;
      resize: none;
      font-size: 1rem;
      font-family: 'JetBrains Mono', 'Fira Mono', 'Menlo', monospace;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      padding: 1rem;
      background: #f9fafb;
      box-sizing: border-box;
      outline: none;
    }
    .pane textarea:focus {
      border: 1.5px solid #4f8cff;
      background: #fff;
    }
    .pane pre {
      white-space: pre-wrap;
      word-break: break-word;
      background: #f8f8fa;
      color: #23272e;
      font-size: 1rem;
      border-radius: 6px;
      padding: 1rem;
      margin: 0;
      min-height: 120px;
      border: 1px solid #ececec;
    }
    .errors {
      margin-top: 1rem;
      background: #fff4e6;
      color: #d9480f;
      border: 1px solid #ffd8a8;
      border-radius: 6px;
      padding: 1rem 1rem 0.2rem 1rem;
      font-size: 1rem;
    }
    .errors span {
      display: block;
      margin-bottom: 0.5em;
    }
    @media (max-width: 800px) {
      .container { flex-direction: column; }
      .pane { min-height: 40vh; padding: 1rem; }
      .pane.left { border-right: none; border-bottom: 1px solid #ececec; }
    }
    mark {
      background: #fff3bf;
      color: #d9480f;
      padding: 0.1em 0.3em;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="pane left">
      <label for="input">Input HTML link tag (malformed allowed):</label>
      <textarea id="input" spellcheck="false" placeholder="Paste your &lt;link&gt; tag here...">
<link rel="icon" hrefa="https://raw.githubusercontent.com/Runarok/GenAI-plus/main/GenAI-plus.png" type="image/png">
      </textarea>
    </div>
    <div class="pane right">
      <label for="output">Corrected Output:</label>
      <pre id="output"></pre>
      <div class="errors" id="errors" style="display:none"></div>
    </div>
  </div>
  <script>
    function parseLinkTag(input) {
      // Regex for basic HTML attribute parsing
      const attrRegex = /([a-zA-Z\-:]+)\s*=\s*(['"])(.*?)\2/g;
      let errors = [];
      let tagMatch = input.match(/<\s*link\s+([^>]+)>/i);
      if (!tagMatch) {
        errors.push("No <link> tag found or malformed tag.");
        return {fixed: '', errors};
      }
      let attrs = tagMatch[1];
      let found = {};
      let correctedAttrs = [];
      let extraAttrs = [];
      let used = {};

      // Collect attributes
      let match;
      while ((match = attrRegex.exec(attrs))) {
        let key = match[1];
        let val = match[3];
        found[key] = val;
        used[key] = true;
      }

      // Detect common mistakes and fix them
      // 1. hrefa should be href
      if (!found.href && found.hrefa) {
        found.href = found.hrefa;
        errors.push(`<mark>hrefa</mark> attribute is not valid. Changed to <mark>href</mark>.`);
        delete found.hrefa;
      }
      // 2. Remove any unexpected attributes
      let allowedKeys = ["rel", "href", "type", "sizes", "media", "crossorigin", "as", "title"];
      for (let key in found) {
        if (!allowedKeys.includes(key)) {
          errors.push(`<mark>${key}</mark> is not a valid attribute for &lt;link&gt;. It has been removed.`);
          extraAttrs.push(key);
        }
      }
      extraAttrs.forEach(key => delete found[key]);

      // 3. Check for missing required attributes
      if (!found.rel) errors.push("<mark>rel</mark> attribute missing.");
      if (!found.href) errors.push("<mark>href</mark> attribute missing.");

      // 4. Add required attributes if missing (with dummy value, user must fill)
      if (!found.rel) found.rel = "icon";
      if (!found.href) found.href = "YOUR_ICON_URL";

      // 5. Build corrected attributes string
      for (const key of allowedKeys) {
        if (found[key]) {
          correctedAttrs.push(`${key}="${found[key]}"`);
        }
      }
      let fixed = `<link ${correctedAttrs.join(' ')}>`;
      return {fixed, errors};
    }

    const $input = document.getElementById('input');
    const $output = document.getElementById('output');
    const $errors = document.getElementById('errors');

    function process() {
      const input = $input.value;
      const {fixed, errors} = parseLinkTag(input);
      $output.textContent = fixed;
      if (errors.length > 0) {
        $errors.innerHTML = errors.map(e => `<span>${e}</span>`).join('');
        $errors.style.display = '';
      } else {
        $errors.innerHTML = '';
        $errors.style.display = 'none';
      }
    }

    $input.addEventListener('input', process);
    process();
  </script>
</body>
</html>