<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Error Detective - Dark Theme</title>
    <link rel="icon" href="https://raw.githubusercontent.com/Runarok/GenAI-plus/main/GenAI-plus.png" type="image/png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: #1a1a1a;
            color: #e0e0e0;
            height: 100vh;
            overflow: hidden;
        }

        .header {
            background: #2d2d2d;
            padding: 1rem;
            border-bottom: 2px solid #404040;
            text-align: center;
        }

        .header h1 {
            color: #61dafb;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: #b0b0b0;
            font-size: 0.9rem;
        }

        .container {
            display: flex;
            height: calc(100vh - 80px);
        }

        .editor-panel {
            flex: 2;
            display: flex;
            flex-direction: column;
            border-right: 2px solid #404040;
        }

        .error-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #1e1e1e;
        }

        .panel-header {
            background: #333;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #404040;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .editor-panel .panel-header {
            color: #61dafb;
        }

        .error-panel .panel-header {
            color: #ff6b6b;
        }

        .error-count {
            background: #ff4757;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            min-width: 20px;
            text-align: center;
        }

        .error-count.clean {
            background: #2ed573;
        }

        .toolbar {
            background: #2d2d2d;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #404040;
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            background: #404040;
            color: #e0e0e0;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.2s;
        }

        .btn:hover {
            background: #505050;
        }

        .btn.primary {
            background: #61dafb;
            color: #1a1a1a;
        }

        .btn.primary:hover {
            background: #4fa8c5;
        }

        .editor-container {
            flex: 1;
            position: relative;
            display: flex;
        }

        .line-numbers {
            background: #252525;
            color: #666;
            padding: 1rem 0.5rem;
            font-size: 14px;
            line-height: 1.5;
            text-align: right;
            min-width: 50px;
            border-right: 1px solid #404040;
            user-select: none;
        }

        .line-numbers .line {
            height: 21px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }

        .line-numbers .line.error {
            background: rgba(255, 71, 87, 0.3);
            color: #ff4757;
            font-weight: bold;
        }

        .line-numbers .line.warning {
            background: rgba(255, 165, 2, 0.3);
            color: #ffa502;
            font-weight: bold;
        }

        #input {
            flex: 1;
            background: #1e1e1e;
            color: #e0e0e0;
            border: none;
            padding: 1rem;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
            outline: none;
            overflow-y: auto;
        }

        #input:focus {
            background: #252525;
        }

        .error-list {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .error-item {
            background: #2d1b1b;
            border: 1px solid #ff4757;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .error-item:hover {
            background: #3d2626;
            border-color: #ff6b6b;
        }

        .error-item:last-child {
            margin-bottom: 0;
        }

        .error-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .error-line-badge {
            background: #ff4757;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .error-type {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .error-description {
            color: #ffb3b3;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .error-code {
            background: #1a1a1a;
            border: 1px solid #404040;
            border-radius: 4px;
            padding: 0.5rem;
            font-family: inherit;
            font-size: 13px;
            color: #ccc;
            margin-bottom: 0.5rem;
        }

        .error-suggestion {
            background: rgba(46, 213, 115, 0.1);
            border: 1px solid #2ed573;
            border-radius: 4px;
            padding: 0.5rem;
            color: #51cf66;
            font-size: 13px;
        }

        .no-errors {
            text-align: center;
            color: #666;
            padding: 2rem;
        }

        .no-errors .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #2ed573;
        }

        .status-bar {
            background: #2d2d2d;
            padding: 0.5rem 1rem;
            border-top: 1px solid #404040;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
        }

        .status-info {
            color: #b0b0b0;
        }

        .cursor-position {
            color: #61dafb;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .editor-panel {
                border-right: none;
                border-bottom: 2px solid #404040;
            }
        }

        /* Syntax highlighting hints */
        .highlight-error {
            background: rgba(255, 71, 87, 0.2);
            border-bottom: 2px solid #ff4757;
        }

        .highlight-warning {
            background: rgba(255, 165, 2, 0.2);
            border-bottom: 2px solid #ffa502;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #2d2d2d;
        }

        ::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîç JSON Error Detective</h1>
        <p>Find and fix errors in your JavaScript objects and JSON with precise line-by-line guidance</p>
    </div>

    <div class="container">
        <div class="editor-panel">
            <div class="panel-header">
                Code Editor
                <span class="error-count" id="errorCount">0 errors</span>
            </div>
            <div class="toolbar">
                <button class="btn" onclick="clearInput()">Clear</button>
                <button class="btn" onclick="loadExample()">Load Example</button>
                <button class="btn primary" onclick="validateCode()">Check Errors</button>
            </div>
            <div class="editor-container">
                <div class="line-numbers" id="lineNumbers"></div>
                <textarea id="input" placeholder="Paste your JavaScript object or JSON here...

Example:
{
  name: 'John Doe',
  age: 30,
  city: 'New York'
  hobbies: ['reading', 'coding', 'gaming',]
  isActive: true,
}"></textarea>
            </div>
            <div class="status-bar">
                <div class="status-info" id="statusInfo">Ready</div>
                <div class="cursor-position" id="cursorPosition">Line 1, Column 1</div>
            </div>
        </div>

        <div class="error-panel">
            <div class="panel-header">
                Error Detective
                <span id="errorSummary">No errors found</span>
            </div>
            <div class="error-list" id="errorList">
                <div class="no-errors">
                    <div class="icon">‚úÖ</div>
                    <h3>No Errors Found</h3>
                    <p>Your code looks clean! Paste some malformed JSON or JavaScript objects to see error detection in action.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        class JSONErrorDetective {
            constructor() {
                this.errors = [];
                this.inputLines = [];
            }

            analyze(input) {
                this.errors = [];
                this.inputLines = input.split('\n');
                
                if (!input.trim()) {
                    return { errors: [] };
                }

                // Detect various types of errors
                this.detectUnquotedKeys(input);
                this.detectQuoteIssues(input);
                this.detectTrailingCommas(input);
                this.detectMissingCommas(input);
                this.detectBracketIssues(input);
                this.detectMissingColons(input);
                this.detectJSONSyntaxErrors(input);
                
                return { errors: this.errors };
            }

            getLineNumber(text, position) {
                const beforePosition = text.substring(0, position);
                return beforePosition.split('\n').length;
            }

            getLineContent(lineNum) {
                return this.inputLines[lineNum - 1] || '';
            }

            addError(type, description, line, column = null, suggestion = null, code = null) {
                this.errors.push({
                    type,
                    description,
                    line,
                    column,
                    suggestion,
                    code: code || this.getLineContent(line).trim()
                });
            }

            detectUnquotedKeys(str) {
                const regex = /([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g;
                let match;
                
                while ((match = regex.exec(str)) !== null) {
                    const lineNum = this.getLineNumber(str, match.index);
                    const key = match[2];
                    
                    this.addError(
                        'Unquoted Key',
                        `Object key "${key}" should be wrapped in double quotes`,
                        lineNum,
                        null,
                        `Change ${key}: to "${key}":`,
                        this.getLineContent(lineNum)
                    );
                }
            }

            detectQuoteIssues(str) {
                const lines = str.split('\n');
                
                lines.forEach((line, index) => {
                    const lineNum = index + 1;
                    
                    // Detect single quotes around strings
                    const singleQuoteRegex = /'([^'\\]|\\.)*'/g;
                    let match;
                    
                    while ((match = singleQuoteRegex.exec(line)) !== null) {
                        this.addError(
                            'Quote Style',
                            'JSON requires double quotes, not single quotes',
                            lineNum,
                            match.index + 1,
                            `Change '${match[0].slice(1, -1)}' to "${match[0].slice(1, -1)}"`,
                            line.trim()
                        );
                    }
                });
            }

            detectTrailingCommas(str) {
                const lines = str.split('\n');
                
                lines.forEach((line, index) => {
                    const lineNum = index + 1;
                    const trimmed = line.trim();
                    
                    if (trimmed.match(/,\s*[}\]]/)) {
                        this.addError(
                            'Trailing Comma',
                            'Trailing commas are not allowed in JSON',
                            lineNum,
                            null,
                            'Remove the comma before the closing bracket/brace',
                            trimmed
                        );
                    }
                });
            }

            detectMissingCommas(str) {
                const lines = str.split('\n');
                
                for (let i = 0; i < lines.length - 1; i++) {
                    const currentLine = lines[i].trim();
                    const nextLine = lines[i + 1].trim();
                    
                    // Check for missing comma between object properties
                    if (currentLine.match(/["}'\d\]]\s*$/) && 
                        nextLine.match(/^["'a-zA-Z_$]/)) {
                        
                        // Skip if current line already ends with comma or is a closing brace/bracket
                        if (!currentLine.endsWith(',') && 
                            !currentLine.endsWith('{') && 
                            !currentLine.endsWith('[')) {
                            
                            this.addError(
                                'Missing Comma',
                                'Missing comma between object properties or array elements',
                                i + 1,
                                null,
                                'Add a comma at the end of this line',
                                currentLine
                            );
                        }
                    }
                }
            }

            detectBracketIssues(str) {
                const stack = [];
                const brackets = { '{': '}', '[': ']', '(': ')' };
                let currentLine = 1;
                let inString = false;
                let stringChar = '';
                let escaped = false;
                
                for (let i = 0; i < str.length; i++) {
                    const char = str[i];
                    
                    if (char === '\n') currentLine++;
                    
                    if (!inString && (char === '"' || char === "'")) {
                        inString = true;
                        stringChar = char;
                    } else if (inString && char === stringChar && !escaped) {
                        inString = false;
                    }
                    
                    if (!inString) {
                        if (char in brackets) {
                            stack.push({ char, line: currentLine, expected: brackets[char] });
                        } else if (Object.values(brackets).includes(char)) {
                            const lastOpen = stack.pop();
                            
                            if (!lastOpen) {
                                this.addError(
                                    'Unmatched Bracket',
                                    `Unexpected closing '${char}' with no matching opening bracket`,
                                    currentLine,
                                    null,
                                    `Remove this '${char}' or add a matching opening bracket`,
                                    this.getLineContent(currentLine)
                                );
                            } else if (lastOpen.expected !== char) {
                                this.addError(
                                    'Bracket Mismatch',
                                    `Expected '${lastOpen.expected}' but found '${char}'`,
                                    currentLine,
                                    null,
                                    `Change '${char}' to '${lastOpen.expected}' or fix the opening bracket on line ${lastOpen.line}`,
                                    this.getLineContent(currentLine)
                                );
                            }
                        }
                    }
                    
                    escaped = char === '\\' && !escaped;
                }
                
                // Report unclosed brackets
                stack.forEach(item => {
                    this.addError(
                        'Unclosed Bracket',
                        `Unclosed '${item.char}' opened on line ${item.line}`,
                        item.line,
                        null,
                        `Add closing '${item.expected}' bracket`,
                        this.getLineContent(item.line)
                    );
                });
            }

            detectMissingColons(str) {
                const lines = str.split('\n');
                
                lines.forEach((line, index) => {
                    const lineNum = index + 1;
                    
                    // Look for pattern: "key" "value" (missing colon)
                    const missingColonRegex = /"([^"]+)"\s+"([^"]+)"/;
                    const match = line.match(missingColonRegex);
                    
                    if (match) {
                        this.addError(
                            'Missing Colon',
                            `Missing colon between key "${match[1]}" and value "${match[2]}"`,
                            lineNum,
                            null,
                            `Add colon: "${match[1]}": "${match[2]}"`,
                            line.trim()
                        );
                    }
                });
            }

            detectJSONSyntaxErrors(str) {
                try {
                    JSON.parse(str);
                } catch (error) {
                    const message = error.message;
                    let lineNum = 1;
                    
                    // Try to extract line information from error message
                    const positionMatch = message.match(/position (\d+)/);
                    if (positionMatch) {
                        const position = parseInt(positionMatch[1]);
                        lineNum = this.getLineNumber(str, position);
                    }
                    
                    // Extract more specific error information
                    let errorType = 'JSON Syntax Error';
                    let suggestion = 'Check the syntax and fix the error';
                    
                    if (message.includes('Unexpected token')) {
                        errorType = 'Unexpected Token';
                        const tokenMatch = message.match(/Unexpected token (.+?) in JSON/);
                        if (tokenMatch) {
                            suggestion = `Remove or fix the unexpected token: ${tokenMatch[1]}`;
                        }
                    } else if (message.includes('Unexpected end')) {
                        errorType = 'Incomplete JSON';
                        suggestion = 'Add missing closing brackets, braces, or quotes';
                    }
                    
                    this.addError(
                        errorType,
                        message,
                        lineNum,
                        null,
                        suggestion,
                        this.getLineContent(lineNum)
                    );
                }
            }
        }

        const detective = new JSONErrorDetective();
        let currentErrors = [];

        function updateLineNumbers() {
            const input = document.getElementById('input');
            const lineNumbers = document.getElementById('lineNumbers');
            const lines = input.value.split('\n');
            
            lineNumbers.innerHTML = '';
            
            lines.forEach((line, index) => {
                const lineNum = index + 1;
                const lineDiv = document.createElement('div');
                lineDiv.className = 'line';
                lineDiv.textContent = lineNum;
                
                // Check if this line has errors
                const hasError = currentErrors.some(error => error.line === lineNum);
                if (hasError) {
                    lineDiv.classList.add('error');
                }
                
                lineNumbers.appendChild(lineDiv);
            });
        }

        function updateCursorPosition() {
            const input = document.getElementById('input');
            const cursorPos = document.getElementById('cursorPosition');
            
            const text = input.value;
            const cursorIndex = input.selectionStart;
            const textBeforeCursor = text.substring(0, cursorIndex);
            const lines = textBeforeCursor.split('\n');
            const currentLine = lines.length;
            const currentColumn = lines[lines.length - 1].length + 1;
            
            cursorPos.textContent = `Line ${currentLine}, Column ${currentColumn}`;
        }

        function analyzeCode() {
            const input = document.getElementById('input').value;
            const result = detective.analyze(input);
            
            currentErrors = result.errors;
            displayErrors(result.errors);
            updateCounters(result.errors.length);
            updateLineNumbers();
            updateStatus(result.errors.length);
        }

        function displayErrors(errors) {
            const errorList = document.getElementById('errorList');
            
            if (errors.length === 0) {
                errorList.innerHTML = `
                    <div class="no-errors">
                        <div class="icon">‚úÖ</div>
                        <h3>No Errors Found</h3>
                        <p>Your code looks clean! Great job on writing valid JSON/JavaScript.</p>
                    </div>
                `;
                return;
            }
            
            errorList.innerHTML = errors.map((error, index) => `
                <div class="error-item" onclick="jumpToLine(${error.line})">
                    <div class="error-header">
                        <div class="error-type">${error.type}</div>
                        <div class="error-line-badge">Line ${error.line}</div>
                    </div>
                    <div class="error-description">${error.description}</div>
                    <div class="error-code">${error.code}</div>
                    ${error.suggestion ? `<div class="error-suggestion">üí° ${error.suggestion}</div>` : ''}
                </div>
            `).join('');
        }

        function jumpToLine(lineNumber) {
            const input = document.getElementById('input');
            const lines = input.value.split('\n');
            
            let charPosition = 0;
            for (let i = 0; i < lineNumber - 1; i++) {
                charPosition += lines[i].length + 1; // +1 for newline
            }
            
            input.focus();
            input.setSelectionRange(charPosition, charPosition + (lines[lineNumber - 1] || '').length);
            input.scrollTop = (lineNumber - 1) * 21; // Approximate line height
        }

        function updateCounters(errorCount) {
            const errorCounter = document.getElementById('errorCount');
            const errorSummary = document.getElementById('errorSummary');
            
            if (errorCount === 0) {
                errorCounter.textContent = 'Clean';
                errorCounter.classList.add('clean');
                errorSummary.textContent = 'No errors found';
            } else {
                errorCounter.textContent = `${errorCount} error${errorCount !== 1 ? 's' : ''}`;
                errorCounter.classList.remove('clean');
                errorSummary.textContent = `${errorCount} error${errorCount !== 1 ? 's' : ''} detected`;
            }
        }

        function updateStatus(errorCount) {
            const statusInfo = document.getElementById('statusInfo');
            
            if (errorCount === 0) {
                statusInfo.textContent = 'Code is valid ‚úÖ';
                statusInfo.style.color = '#2ed573';
            } else {
                statusInfo.textContent = `${errorCount} error${errorCount !== 1 ? 's' : ''} found ‚ùå`;
                statusInfo.style.color = '#ff4757';
            }
        }

        function clearInput() {
            document.getElementById('input').value = '';
            currentErrors = [];
            displayErrors([]);
            updateCounters(0);
            updateLineNumbers();
            updateStatus(0);
        }

        function loadExample() {
            const example = `{
  name: 'John Doe',
  age: 30,
  city: 'New York'
  hobbies: ['reading', 'coding', 'gaming',]
  isActive: true,
  address: {
    street: "123 Main St"
    zipCode: 10001
  }
}`;
            document.getElementById('input').value = example;
            analyzeCode();
        }

        function validateCode() {
            analyzeCode();
        }

        // Event listeners
        document.getElementById('input').addEventListener('input', () => {
            updateLineNumbers();
            updateCursorPosition();
            // Auto-analyze with debouncing
            clearTimeout(window.analyzeTimeout);
            window.analyzeTimeout = setTimeout(analyzeCode, 500);
        });

        document.getElementById('input').addEventListener('keyup', updateCursorPosition);
        document.getElementById('input').addEventListener('click', updateCursorPosition);

        // Initialize
        window.addEventListener('load', () => {
            updateLineNumbers();
            updateCursorPosition();
            setTimeout(loadExample, 500);
        });
    </script>
</body>
</html>