<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Birthday Card</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- NOTE: fixed typo in hrefa -> href -->
  <link rel="icon" href="https://raw.githubusercontent.com/Runarok/GenAI-plus/main/GenAI-plus.png" type="image/png">
  <style>
    :root {
      --primary-accent: #ff4081;
      --radius: 18px;
      --shadow: 0 8px 32px #0005;
      --bg-dark: #18181b;
      --bg-light: #fffbe6;
      --card-bg-dark: #232323;
      --card-bg-light: #fff;
      --text-dark: #fff;
      --text-light: #222;
    }
    html, body {
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }
    body {
      background: var(--bg-dark);
      color: var(--text-dark);
      font-family: 'Segoe UI', Arial, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.4s, color 0.4s;
    }
    body.light {
      background: var(--bg-light);
      color: var(--text-light);
    }
    .container {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .input, .card {
      background: var(--card-bg-dark);
      color: var(--text-dark);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 2em 1.2em 1.6em 1.2em;
      margin: 0 auto;
      transition: background 0.4s, box-shadow 0.4s, color 0.4s;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    body.light .input, body.light .card {
      background: var(--card-bg-light);
      color: var(--text-light);
      box-shadow: 0 8px 32px #0002;
    }
    .input h1 {
      font-size: 2.1em;
      margin-bottom: 20px;
      color: var(--primary-accent);
      font-family: 'Pacifico', cursive, Arial, sans-serif;
      letter-spacing: 0.04em;
      text-align: center;
      width: 100%;
    }
    .input input[type="text"] {
      padding: 11px 12px;
      font-size: 1.1em;
      border-radius: 6px;
      border: 1.5px solid #ccc;
      width: 92%;
      margin-bottom: 1.2em;
      outline: none;
      background: #292929;
      color: #fff;
      transition: border .25s, background .25s, color .25s;
      text-align: center;
    }
    body.light .input input[type="text"] {
      background: #fffbe6;
      color: #222;
      border-color: #eee;
    }
    .selects {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 1.35em;
      gap: 1em;
      flex-wrap: wrap;
      width: 100%;
    }
    select {
      padding: 0.6em 1.1em;
      border-radius: 7px;
      font-size: 1em;
      border: 1.5px solid #ccc;
      background: #232323;
      color: #fff;
      transition: background .25s, color .25s, border .25s;
      outline: none;
    }
    body.light select {
      background: #fffbe6;
      color: #222;
      border-color: #eee;
    }
    .colors {
      display: inline-flex;
      gap: 7px;
      align-items: center;
      margin-left: 0.2em;
    }
    .dot {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      display: inline-block;
      cursor: pointer;
      border: 2.5px solid #fff4;
      transition: border .2s;
      box-sizing: border-box;
      outline: none;
    }
    .dot.selected {
      border: 2.5px solid var(--primary-accent);
      outline: 2px solid #ffbebe;
    }
    button {
      background: var(--primary-accent);
      border: none;
      color: #fff;
      border-radius: 7px;
      padding: 0.7em 1.7em;
      font-size: 1.08em;
      margin: 0.7em 0.35em;
      cursor: pointer;
      font-weight: 500;
      letter-spacing: 0.03em;
      transition: background .23s;
      box-shadow: 0 2px 12px rgba(255,64,129,0.07);
    }
    button:hover, button:focus {
      background: #e61e6e;
    }
    .card h1 {
      color: var(--primary-accent);
      font-family: 'Pacifico', cursive, Arial, sans-serif;
      font-size: 2em;
      margin-top: 0.2em;
      margin-bottom: .35em;
      letter-spacing: 0.04em;
      width: 100%;
      text-align: center;
    }
    .card p {
      font-size: 1.17em;
      margin-bottom: 1.2em;
      margin-top: 0.7em;
      color: #e0e0e0;
      line-height: 1.5;
      text-align: center;
      width: 100%;
    }
    body.light .card p { color: #3c3c3c; }
    .card img {
      width: 240px;
      max-width: 100%;
      border-radius: 13px;
      margin-top: 1.2em;
      box-shadow: 0 2px 16px #ff408135;
      background: #fff2;
      display: block;
      margin-left: auto;
      margin-right: auto;
      transition: box-shadow 0.3s;
      /* Ensures the image is always shown properly */
      object-fit: cover;
      aspect-ratio: 4/3;
      background: #eee;
    }
    .card img:active, .card img:focus {
      box-shadow: 0 4px 28px #ff4081a0;
    }
    .toast {
      position:fixed; bottom:18px; left:50%; transform:translateX(-50%);
      background:#232323; color:#fff; padding:0.7em 2em; border-radius:5px;
      opacity:0; pointer-events:none; transition:.30s; z-index:99; font-size:1.13em;
      box-shadow: 0 4px 14px #0005;
    }
    .toast.show { opacity:1; }
    body.light .toast { background: #fffbe6; color: #232323; box-shadow: 0 4px 12px #ff408112;}
    @media (max-width: 520px) {
      .input, .card { padding: 1.2em 0.3em; }
      .card img { width: 98vw; max-width: 98vw; }
      .container { max-width: 99vw; }
      .selects { flex-direction: column; gap: .7em;}
    }
  </style>
  <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet">
</head>
<body>
<div class="container">
  <div id="inputSection" class="input">
    <h1>Birthday Card Generator</h1>
    <input id="name" type="text" maxlength="36" placeholder="Recipient Name"><br>
    <div class="selects">
      <select id="quoteSel"></select>
      <select id="themeSel">
        <option value="d">Dark</option>
        <option value="l">Light</option>
      </select>
      <span class="colors" id="accentDots"></span>
    </div>
    <div style="width:100%;display:flex;justify-content:center;">
      <button id="copyBtn">Copy Link</button>
      <button id="previewBtn">Preview</button>
    </div>
  </div>
  <div id="cardSection" class="card" style="display:none;">
    <h1 id="cardTitle"></h1>
    <p id="cardMsg"></p>
    <img id="cardImg" src="">
  </div>
  <div id="toast" class="toast"></div>
</div>
<script>
// --- Data ---
const quotes = [
  "Wishing you a day filled with happiness and a year filled with joy!",
  "May your birthday be the start of a year filled with good luck, good health, and much happiness.",
  "Happy Birthday! May your day be filled with love, laughter, and joy!",
  "On your special day, may you be surrounded by love and happiness! Enjoy every moment!",
  "Sending you smiles for every moment of your special day… Have a wonderful time and a very happy birthday!",
  "Cheers to you and your incredible journey ahead. Have a fantastic birthday!",
  "Here's to another year of making beautiful memories! Happy Birthday!",
  "May your heart be filled with joy and laughter on your special day. Happy Birthday!",
  "On your birthday, may the sun shine as brightly as your spirit. Enjoy every moment!",
  "Wishing you a year full of love, adventure, and endless possibilities. Happy Birthday!",
  "Birthdays are nature’s way of telling us to eat more cake! Have a sweet and delightful day!",
  "Your birthday is the perfect time to remind you how much you are loved. Have a wonderful day!",
  "Wishing you a lifetime of happiness, peace, and prosperity. Happy Birthday!",
  "May your birthday be filled with all your favorite things and surrounded by the ones you love. Enjoy!",
  "Blow out the candles and make a wish. Happy Birthday!"
];
const images = [
  "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=640&q=80",
  "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=640&q=80",
  "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=640&q=80",
  "https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=640&q=80",
  "https://cdn.pixabay.com/photo/2017/01/31/13/14/birthday-2028658_1280.png",
  "https://cdn.pixabay.com/photo/2014/12/21/23/50/birthday-579520_1280.png",
  "https://cdn.pixabay.com/photo/2016/03/23/17/33/birthday-1276269_1280.png",
  "https://images.pexels.com/photos/2072181/pexels-photo-2072181.jpeg?auto=compress&w=640&h=427&fit=crop",
  "https://images.pexels.com/photos/796602/pexels-photo-796602.jpeg?auto=compress&w=640&h=427&fit=crop",
  "https://images.pexels.com/photos/1721938/pexels-photo-1721938.jpeg?auto=compress&w=640&h=427&fit=crop"
];
const accents = [
  {name:'Pink', hex:'#ff4081'}, {name:'Blue',hex:'#6c63ff'}, {name:'Green',hex:'#00b894'},
  {name:'Yellow',hex:'#ffee58'}, {name:'Orange',hex:'#ffb74d'}, {name:'Purple',hex:'#a29bfe'},
  {name:'Red',hex:'#ff5252'}, {name:'Teal',hex:'#1de9b6'}
];

// --- Encoding: <b64name>|<quoteId>|<themeBit> ---
// quoteId: 0-14 or r for random
// themeBit: <d/l><accentIdx as 0-7>
function encodeState(name, quoteId, themeBase, accentIdx) {
  return btoa(unescape(encodeURIComponent(name))).replace(/=+$/,'') + "|" +
    (quoteId === null ? "r" : quoteId.toString(36)) + "|" + themeBase + accentIdx;
}
function decodeState(hash) {
  let [b64name, quoteStr, themeBit] = hash.split("|");
  if(!b64name || !themeBit) return null;
  let name;
  try { name = decodeURIComponent(escape(atob(b64name))); } catch(e){ return null; }
  let quote = (quoteStr === "r" || quoteStr == null) ? null : parseInt(quoteStr,36);
  let base = themeBit[0]==="l" ? "l" : "d";
  let accent = +themeBit[1];
  if(isNaN(accent) || accent < 0 || accent >= accents.length) accent = 0;
  return { name, quote, theme: { base, accent }};
}

function setAccent(idx){document.documentElement.style.setProperty('--primary-accent',accents[idx].hex);}
function setTheme(base,accentIdx){document.body.className=(base==="l"?"light":"");setAccent(accentIdx);}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1800);}

function showMenu(){
  document.getElementById('inputSection').style.display = "";
  document.getElementById('cardSection').style.display = "none";
}
function showCard(name, quoteIdx, themeObj){
  setTheme(themeObj.base, themeObj.accent);
  document.getElementById('inputSection').style.display = "none";
  document.getElementById('cardSection').style.display = "";
  document.getElementById('cardTitle').textContent = `Happy Birthday, ${name}!`;
  let q = (typeof quoteIdx === "number" && quoteIdx >= 0 && quoteIdx < quotes.length) ? quotes[quoteIdx] : quotes[Math.floor(Math.random()*quotes.length)];
  document.getElementById('cardMsg').textContent = q;
  let img = document.getElementById('cardImg');
  let src = images[Math.floor(Math.random()*images.length)];
  img.onload = null;
  img.onerror = null;
  img.style.display = "block"; // Always show image now
  img.src = src;
}

function initMenu(){
  let quoteSel = document.getElementById('quoteSel');
  quoteSel.innerHTML = `<option value="r">🎲 Random</option>`+quotes.map((q,i)=>`<option value="${i}">${(i+1)+"."}</option>`).join('');
  let themeSel = document.getElementById('themeSel');
  let accentDots = document.getElementById('accentDots');
  accentDots.innerHTML = '';
  accents.forEach((a,i)=>{
    let d=document.createElement('span');
    d.className='dot'+(i==0?' selected':'');
    d.style.background=a.hex;
    d.title=a.name;
    d.onclick=()=>{
      Array.from(accentDots.children).forEach(c=>c.classList.remove('selected'));
      d.classList.add('selected');
      setAccent(i);
      accentDots.setAttribute('data-accent',i);
    };
    accentDots.appendChild(d);
  });
  setAccent(0);
  accentDots.setAttribute('data-accent',0);

  themeSel.onchange = ()=> setTheme(themeSel.value, parseInt(accentDots.getAttribute('data-accent')));
  // For friendly preview of quote on change:
  quoteSel.onchange = ()=> showQuotePreview();
  showQuotePreview();
}

function getStateFromMenu(){
  let name = document.getElementById('name').value.trim();
  let quoteVal = document.getElementById('quoteSel').value;
  let quote = quoteVal === "r" ? null : parseInt(quoteVal,10);
  let base = document.getElementById('themeSel').value;
  let accent = parseInt(document.getElementById('accentDots').getAttribute('data-accent'));
  return {name, quote, theme:{base, accent}};
}
function showQuotePreview(){
  let quoteVal = document.getElementById('quoteSel').value;
  let idx = quoteVal === "r" ? null : parseInt(quoteVal,10);
  let preview = document.getElementById('quoteSel');
  if (idx!==null && quotes[idx]) preview.title = quotes[idx];
  else preview.title = "Random birthday wish";
}

window.onload = function(){
  let hash = location.hash.replace(/^#/,'');
  let previewMode = !!window.location.search;
  let data = hash && decodeState(hash);
  if(data && data.name){
    document.getElementById('inputSection').style.display = "none";
    document.getElementById('cardSection').style.display = "";
    setTheme(data.theme.base, data.theme.accent);
    document.getElementById('cardTitle').textContent = `Happy Birthday, ${data.name}!`;
    let q = (typeof data.quote === "number" && data.quote >= 0 && data.quote < quotes.length) ? quotes[data.quote] : quotes[Math.floor(Math.random()*quotes.length)];
    document.getElementById('cardMsg').textContent = q;
    let img = document.getElementById('cardImg');
    let src = images[Math.floor(Math.random()*images.length)];
    img.onload = null;
    img.onerror = null;
    img.style.display = "block"; // Always show image now
    img.src = src;
    if(previewMode){
      document.body.innerHTML = document.getElementById('cardSection').outerHTML;
      setTheme(data.theme.base, data.theme.accent);
    }
    return;
  }
  showMenu();
  initMenu();
  document.getElementById('copyBtn').onclick = function(){
    let s = getStateFromMenu();
    if(!s.name) return showToast("Please enter a name!");
    let url = window.location.origin+window.location.pathname+"#"+encodeState(s.name, s.quote, s.theme.base, s.theme.accent);
    navigator.clipboard.writeText(url).then(()=>showToast("Link copied!"));
  };
  document.getElementById('previewBtn').onclick = function(){
    let s = getStateFromMenu();
    if(!s.name) return showToast("Please enter a name!");
    let url = window.location.origin+window.location.pathname+"?t#"+encodeState(s.name, s.quote, s.theme.base, s.theme.accent);
    window.open(url,"_blank");
  };
};
</script>
</body>
</html>