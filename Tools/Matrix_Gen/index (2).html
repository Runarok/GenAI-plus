<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Matrix Generator</title>
    <link rel="icon" href="https://raw.githubusercontent.com/Runarok/GenAI-plus/main/GenAI-plus.png" type="image/png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-hover: #5855eb;
            --secondary: #8b5cf6;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border: #475569;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --radius: 0.5rem;
            --transition: all 0.2s ease-in-out;
        }

        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border: #cbd5e1;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        [data-theme="ocean"] {
            --primary: #0ea5e9;
            --primary-hover: #0284c7;
            --secondary: #06b6d4;
            --accent: #8b5cf6;
            --bg-primary: #0c4a6e;
            --bg-secondary: #075985;
            --bg-tertiary: #0369a1;
            --text-primary: #e0f2fe;
            --text-secondary: #b3e5fc;
            --text-muted: #81d4fa;
            --border: #0284c7;
        }

        [data-theme="forest"] {
            --primary: #059669;
            --primary-hover: #047857;
            --secondary: #10b981;
            --accent: #34d399;
            --bg-primary: #064e3b;
            --bg-secondary: #065f46;
            --bg-tertiary: #047857;
            --text-primary: #ecfdf5;
            --text-secondary: #d1fae5;
            --text-muted: #a7f3d0;
            --border: #059669;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .theme-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .theme-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 0.5rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
        }

        .theme-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-1px);
        }

        .theme-btn.active {
            background: var(--primary);
            color: white;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            flex: 1;
        }

        .matrix-section {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .controls-section {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 1rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .matrix-container {
            overflow: auto;
            max-height: 70vh;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--bg-primary);
        }

        .matrix-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-family: 'JetBrains Mono', monospace;
        }

        .matrix-cell {
            padding: 0.5rem;
            text-align: center;
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
            transition: var(--transition);
            font-size: 0.875rem;
            min-width: 60px;
        }

        .matrix-cell:hover {
            background: var(--bg-tertiary);
        }

        .matrix-cell.diagonal {
            background: var(--primary) !important;
            color: white;
        }

        .matrix-cell.positive {
            background: rgba(16, 185, 129, 0.2);
        }

        .matrix-cell.negative {
            background: rgba(239, 68, 68, 0.2);
        }

        .matrix-cell.zero {
            background: rgba(100, 116, 139, 0.2);
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .input-field {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.875rem;
            transition: var(--transition);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.75rem 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .select-field {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.875rem;
            cursor: pointer;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .checkbox {
            width: 1rem;
            height: 1rem;
            accent-color: var(--primary);
        }

        .stats {
            background: var(--bg-primary);
            padding: 1rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            margin-top: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }

        .stat-item {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .stat-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: var(--radius);
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            border: 1px solid var(--border);
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
        }

        .matrix-actions {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .matrix-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: var(--bg-primary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .controls-section {
                position: static;
                order: -1;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .matrix-container {
                max-height: 50vh;
            }

            .btn-group {
                grid-template-columns: 1fr;
            }

            .input-group {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0.5rem;
            }

            .matrix-section, .controls-section {
                padding: 1rem;
            }

            .matrix-cell {
                padding: 0.25rem;
                font-size: 0.75rem;
                min-width: 40px;
            }
        }

        /* Dark mode preference */
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme]) {
                /* Dark theme is already default */
            }
        }
    </style>
</head>
<body data-theme="dark">
    <div class="container">
        <header class="header">
            <div class="logo">
                <i class="fas fa-calculator"></i>
                Interactive Matrix Generator
            </div>
            <div class="theme-switcher">
                <button class="theme-btn active" data-theme="dark" title="Dark Theme">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="theme-btn" data-theme="light" title="Light Theme">
                    <i class="fas fa-sun"></i>
                </button>
                <button class="theme-btn" data-theme="ocean" title="Ocean Theme">
                    <i class="fas fa-water"></i>
                </button>
                <button class="theme-btn" data-theme="forest" title="Forest Theme">
                    <i class="fas fa-tree"></i>
                </button>
            </div>
        </header>

        <main class="main-content">
            <section class="matrix-section">
                <div class="section-title">
                    <i class="fas fa-th"></i>
                    Matrix Display
                </div>
                
                <div class="matrix-info">
                    <div>
                        <strong id="matrix-size">3×3 Matrix</strong>
                        <span class="text-muted" id="matrix-type">Random</span>
                    </div>
                    <div class="matrix-actions">
                        <button class="btn btn-secondary" onclick="copyMatrix()" title="Copy to Clipboard">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button class="btn btn-secondary" onclick="exportCSV()" title="Export as CSV">
                            <i class="fas fa-file-csv"></i>
                        </button>
                        <button class="btn btn-secondary" onclick="exportText()" title="Export as Text">
                            <i class="fas fa-file-alt"></i>
                        </button>
                    </div>
                </div>

                <div class="matrix-container">
                    <table class="matrix-table" id="matrix-table">
                        <!-- Matrix will be generated here -->
                    </table>
                </div>

                <div class="stats">
                    <div class="stats-grid" id="matrix-stats">
                        <!-- Stats will be displayed here -->
                    </div>
                </div>
            </section>

            <section class="controls-section">
                <div class="section-title">
                    <i class="fas fa-cog"></i>
                    Controls
                </div>

                <div class="control-group">
                    <label class="control-label tooltip" data-tooltip="Set matrix dimensions">
                        <i class="fas fa-expand-arrows-alt"></i>
                        Dimensions
                    </label>
                    <div class="input-group">
                        <input type="number" class="input-field" id="rows" value="3" min="1" max="20" placeholder="Rows">
                        <input type="number" class="input-field" id="cols" value="3" min="1" max="20" placeholder="Cols">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label tooltip" data-tooltip="Value range for random numbers">
                        <i class="fas fa-arrows-alt-h"></i>
                        Value Range
                    </label>
                    <div class="input-group">
                        <input type="number" class="input-field" id="min-val" value="-10" placeholder="Min">
                        <input type="number" class="input-field" id="max-val" value="10" placeholder="Max">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-list"></i>
                        Generation Mode
                    </label>
                    <select class="select-field" id="matrix-mode">
                        <option value="random">Random Fill</option>
                        <option value="identity">Identity Matrix</option>
                        <option value="zero">Zero Matrix</option>
                        <option value="sparse">Sparse Matrix</option>
                        <option value="diagonal">Diagonal Matrix</option>
                    </select>
                </div>

                <div class="control-group">
                    <div class="checkbox-group">
                        <input type="checkbox" class="checkbox" id="decimals">
                        <label for="decimals" class="control-label">Use Decimals</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" class="checkbox" id="highlight-diagonal">
                        <label for="highlight-diagonal" class="control-label">Highlight Diagonal</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" class="checkbox" id="color-coding" checked>
                        <label for="color-coding" class="control-label">Color Coding</label>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label tooltip" data-tooltip="Enter a seed for reproducible random generation">
                        <i class="fas fa-seedling"></i>
                        Random Seed
                    </label>
                    <input type="text" class="input-field" id="seed-input" placeholder="Enter seed (optional)">
                </div>

                <div class="btn-group">
                    <button class="btn" onclick="generateMatrix()">
                        <i class="fas fa-sync-alt"></i>
                        Generate
                    </button>
                    <button class="btn btn-secondary" onclick="transposeMatrix()">
                        <i class="fas fa-exchange-alt"></i>
                        Transpose
                    </button>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="sortRows()">
                        <i class="fas fa-sort-amount-down"></i>
                        Sort Rows
                    </button>
                    <button class="btn btn-secondary" onclick="sortCols()">
                        <i class="fas fa-sort-amount-down fa-rotate-90"></i>
                        Sort Cols
                    </button>
                </div>

                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-magic"></i>
                        Quick Actions
                    </label>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="fillOnes()" title="Fill with 1s">
                            <i class="fas fa-fill"></i>
                            Ones
                        </button>
                        <button class="btn btn-secondary" onclick="generateRandomSeed()" title="Generate Random Seed">
                            <i class="fas fa-dice"></i>
                            Random Seed
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Global variables
        let currentMatrix = [];
        let matrixStats = {};

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            setupEventListeners();
            generateMatrix();
        });

        // Theme management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('matrix-theme') || 'dark';
            setTheme(savedTheme);
        }

        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('matrix-theme', theme);
            
            // Update active theme button
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-theme') === theme) {
                    btn.classList.add('active');
                }
            });
        }

        // Event listeners
        function setupEventListeners() {
            // Theme switcher
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', () => setTheme(btn.getAttribute('data-theme')));
            });

            // Auto-generate on input change
            ['rows', 'cols', 'min-val', 'max-val', 'matrix-mode'].forEach(id => {
                document.getElementById(id).addEventListener('change', function() {
                    // If there's a seed, use it; otherwise generate normally
                    const currentSeed = document.getElementById('seed-input').value.trim();
                    if (currentSeed) {
                        generateMatrixWithSeed(currentSeed);
                    } else {
                        generateMatrix();
                    }
                });
            });

            ['decimals', 'highlight-diagonal', 'color-coding'].forEach(id => {
                document.getElementById(id).addEventListener('change', updateMatrixDisplay);
            });

            // Seed input - apply seed when Enter is pressed
            document.getElementById('seed-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    applySeed();
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'r':
                            e.preventDefault();
                            generateMatrix();
                            break;
                        case 'c':
                            if (e.shiftKey) {
                                e.preventDefault();
                                copyMatrix();
                            }
                            break;
                        case 't':
                            e.preventDefault();
                            transposeMatrix();
                            break;
                        case 's':
                            if (e.shiftKey) {
                                e.preventDefault();
                                const currentSeed = document.getElementById('seed-input').value.trim();
                                if (currentSeed) {
                                    applySeed();
                                } else {
                                    generateRandomSeed();
                                }
                            }
                            break;
                    }
                }
            });

            // Input validation
            document.querySelectorAll('input[type="number"]').forEach(input => {
                input.addEventListener('input', validateInput);
            });
        }

        // Input validation
        function validateInput(e) {
            const input = e.target;
            const value = parseFloat(input.value);
            const min = parseFloat(input.min);
            const max = parseFloat(input.max);

            if (isNaN(value)) return;

            if (min && value < min) {
                input.value = min;
                showNotification('Value adjusted to minimum limit', 'warning');
            }
            if (max && value > max) {
                input.value = max;
                showNotification('Value adjusted to maximum limit', 'warning');
            }
        }

        // Matrix generation
        function generateMatrix() {
            // Get current seed and reapply it to ensure consistency
            const currentSeed = document.getElementById('seed-input').value.trim();
            if (currentSeed) {
                Math.seedrandom(currentSeed);
            }
            
            const rows = parseInt(document.getElementById('rows').value) || 3;
            const cols = parseInt(document.getElementById('cols').value) || 3;
            const minVal = parseFloat(document.getElementById('min-val').value) || -10;
            const maxVal = parseFloat(document.getElementById('max-val').value) || 10;
            const mode = document.getElementById('matrix-mode').value;
            const useDecimals = document.getElementById('decimals').checked;

            // Validate range
            if (minVal >= maxVal) {
                showNotification('Minimum value must be less than maximum value', 'error');
                return;
            }

            currentMatrix = [];

            // Generate matrix based on mode
            switch (mode) {
                case 'identity':
                    currentMatrix = generateIdentityMatrix(rows, cols);
                    break;
                case 'zero':
                    currentMatrix = generateZeroMatrix(rows, cols);
                    break;
                case 'sparse':
                    currentMatrix = generateSparseMatrix(rows, cols, minVal, maxVal, useDecimals);
                    break;
                case 'diagonal':
                    currentMatrix = generateDiagonalMatrix(rows, cols, minVal, maxVal, useDecimals);
                    break;
                default:
                    currentMatrix = generateRandomMatrix(rows, cols, minVal, maxVal, useDecimals);
            }

            updateMatrixDisplay();
            calculateStats();
            updateMatrixInfo(rows, cols, mode);
            
            // Add fade-in animation
            document.querySelector('.matrix-table').classList.add('fade-in');
            setTimeout(() => {
                document.querySelector('.matrix-table').classList.remove('fade-in');
            }, 300);
        }

        function generateRandomMatrix(rows, cols, min, max, useDecimals) {
            const matrix = [];
            for (let i = 0; i < rows; i++) {
                matrix[i] = [];
                for (let j = 0; j < cols; j++) {
                    const value = Math.random() * (max - min) + min;
                    matrix[i][j] = useDecimals ? parseFloat(value.toFixed(2)) : Math.round(value);
                }
            }
            return matrix;
        }

        function generateIdentityMatrix(rows, cols) {
            const matrix = [];
            for (let i = 0; i < rows; i++) {
                matrix[i] = [];
                for (let j = 0; j < cols; j++) {
                    matrix[i][j] = i === j ? 1 : 0;
                }
            }
            return matrix;
        }

        function generateZeroMatrix(rows, cols) {
            const matrix = [];
            for (let i = 0; i < rows; i++) {
                matrix[i] = new Array(cols).fill(0);
            }
            return matrix;
        }

        function generateSparseMatrix(rows, cols, min, max, useDecimals) {
            const matrix = generateZeroMatrix(rows, cols);
            const sparsity = 0.7; // 70% zeros
            const nonZeroCount = Math.floor(rows * cols * (1 - sparsity));
            
            for (let k = 0; k < nonZeroCount; k++) {
                const i = Math.floor(Math.random() * rows);
                const j = Math.floor(Math.random() * cols);
                const value = Math.random() * (max - min) + min;
                matrix[i][j] = useDecimals ? parseFloat(value.toFixed(2)) : Math.round(value);
            }
            return matrix;
        }

        function generateDiagonalMatrix(rows, cols, min, max, useDecimals) {
            const matrix = generateZeroMatrix(rows, cols);
            const size = Math.min(rows, cols);
            
            for (let i = 0; i < size; i++) {
                const value = Math.random() * (max - min) + min;
                matrix[i][i] = useDecimals ? parseFloat(value.toFixed(2)) : Math.round(value);
            }
            return matrix;
        }

        // Matrix display
        function updateMatrixDisplay() {
            const table = document.getElementById('matrix-table');
            const highlightDiagonal = document.getElementById('highlight-diagonal').checked;
            const colorCoding = document.getElementById('color-coding').checked;
            
            let html = '';
            
            for (let i = 0; i < currentMatrix.length; i++) {
                html += '<tr>';
                for (let j = 0; j < currentMatrix[i].length; j++) {
                    const value = currentMatrix[i][j];
                    let cellClass = 'matrix-cell';
                    
                    if (highlightDiagonal && i === j) {
                        cellClass += ' diagonal';
                    } else if (colorCoding) {
                        if (value > 0) cellClass += ' positive';
                        else if (value < 0) cellClass += ' negative';
                        else cellClass += ' zero';
                    }
                    
                    html += `<td class="${cellClass}" data-row="${i}" data-col="${j}">${value}</td>`;
                }
                html += '</tr>';
            }
            
            table.innerHTML = html;
            
            // Add cell hover effects
            document.querySelectorAll('.matrix-cell').forEach(cell => {
                cell.addEventListener('click', function() {
                    highlightRowCol(this.dataset.row, this.dataset.col);
                });
            });
        }

        function highlightRowCol(row, col) {
            // Remove previous highlights
            document.querySelectorAll('.matrix-cell').forEach(cell => {
                cell.style.outline = '';
            });
            
            // Highlight row and column
            document.querySelectorAll(`[data-row="${row}"]`).forEach(cell => {
                cell.style.outline = '2px solid var(--accent)';
            });
            document.querySelectorAll(`[data-col="${col}"]`).forEach(cell => {
                cell.style.outline = '2px solid var(--secondary)';
            });
            
            // Highlight clicked cell
            document.querySelector(`[data-row="${row}"][data-col="${col}"]`).style.outline = '3px solid var(--primary)';
        }

        // Matrix operations
        function transposeMatrix() {
            if (currentMatrix.length === 0) return;
            
            const transposed = [];
            for (let j = 0; j < currentMatrix[0].length; j++) {
                transposed[j] = [];
                for (let i = 0; i < currentMatrix.length; i++) {
                    transposed[j][i] = currentMatrix[i][j];
                }
            }
            
            currentMatrix = transposed;
            updateMatrixDisplay();
            calculateStats();
            updateMatrixInfo(currentMatrix.length, currentMatrix[0].length, 'Transposed');
            showNotification('Matrix transposed successfully', 'success');
        }

        function sortRows() {
            currentMatrix.forEach(row => {
                row.sort((a, b) => a - b);
            });
            updateMatrixDisplay();
            calculateStats();
            showNotification('Rows sorted successfully', 'success');
        }

        function sortCols() {
            if (currentMatrix.length === 0) return;
            
            for (let j = 0; j < currentMatrix[0].length; j++) {
                const column = [];
                for (let i = 0; i < currentMatrix.length; i++) {
                    column.push(currentMatrix[i][j]);
                }
                column.sort((a, b) => a - b);
                for (let i = 0; i < currentMatrix.length; i++) {
                    currentMatrix[i][j] = column[i];
                }
            }
            
            updateMatrixDisplay();
            calculateStats();
            showNotification('Columns sorted successfully', 'success');
        }

        function fillOnes() {
            for (let i = 0; i < currentMatrix.length; i++) {
                for (let j = 0; j < currentMatrix[i].length; j++) {
                    currentMatrix[i][j] = 1;
                }
            }
            updateMatrixDisplay();
            calculateStats();
            showNotification('Matrix filled with ones', 'success');
        }

        function randomSeed() {
            // Generate a random seed and apply it
            const seed = Date.now().toString();
            document.getElementById('seed-input').value = seed;
            applySeed();
        }

        function applySeed() {
            let seed = document.getElementById('seed-input').value.trim();
            
            // If no seed provided, generate a random one
            if (!seed) {
                seed = Date.now().toString();
                document.getElementById('seed-input').value = seed;
            }
            
            // Store the seed and regenerate matrix
            generateMatrixWithSeed(seed);
            showNotification(`Seed applied: ${seed}`, 'success');
        }

        function generateMatrixWithSeed(seed) {
            // Apply the seed right before generation to ensure consistency
            Math.seedrandom(seed);
            generateMatrix();
        }

        function generateRandomSeed() {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            // Use a separate random generator for seed generation to avoid affecting the main seed
            const tempRng = new Math.seedrandom();
            for (let i = 0; i < 8; i++) {
                result += characters.charAt(Math.floor(tempRng() * characters.length));
            }
            document.getElementById('seed-input').value = result;
            generateMatrixWithSeed(result);
        }

        // Statistics calculation
        function calculateStats() {
            if (currentMatrix.length === 0) return;
            
            const flatMatrix = currentMatrix.flat();
            const sum = flatMatrix.reduce((a, b) => a + b, 0);
            const mean = sum / flatMatrix.length;
            const min = Math.min(...flatMatrix);
            const max = Math.max(...flatMatrix);
            
            // Calculate row and column totals
            const rowTotals = currentMatrix.map(row => row.reduce((a, b) => a + b, 0));
            const colTotals = [];
            for (let j = 0; j < currentMatrix[0].length; j++) {
                let total = 0;
                for (let i = 0; i < currentMatrix.length; i++) {
                    total += currentMatrix[i][j];
                }
                colTotals.push(total);
            }
            
            matrixStats = {
                sum: sum.toFixed(2),
                mean: mean.toFixed(2),
                min: min,
                max: max,
                rowTotals: rowTotals.map(t => t.toFixed(2)),
                colTotals: colTotals.map(t => t.toFixed(2)),
                determinant: currentMatrix.length === currentMatrix[0].length ? 
                    calculateDeterminant(currentMatrix).toFixed(2) : 'N/A'
            };
            
            displayStats();
        }

        function calculateDeterminant(matrix) {
            const n = matrix.length;
            if (n !== matrix[0].length) return NaN;
            if (n === 1) return matrix[0][0];
            if (n === 2) return matrix[0][0] * matrix[1][1] - matrix[0][1] * matrix[1][0];
            
            // For larger matrices, use simplified calculation (not full LU decomposition)
            // This is a basic implementation for demonstration
            let det = 0;
            for (let i = 0; i < n; i++) {
                det += Math.pow(-1, i) * matrix[0][i] * calculateMinorDeterminant(matrix, 0, i);
            }
            return det;
        }

        function calculateMinorDeterminant(matrix, row, col) {
            const n = matrix.length;
            const minor = [];
            for (let i = 0; i < n; i++) {
                if (i === row) continue;
                const minorRow = [];
                for (let j = 0; j < n; j++) {
                    if (j === col) continue;
                    minorRow.push(matrix[i][j]);
                }
                minor.push(minorRow);
            }
            return calculateDeterminant(minor);
        }

        function displayStats() {
            const statsContainer = document.getElementById('matrix-stats');
            statsContainer.innerHTML = `
                <div class="stat-item">Sum: <span class="stat-value">${matrixStats.sum}</span></div>
                <div class="stat-item">Mean: <span class="stat-value">${matrixStats.mean}</span></div>
                <div class="stat-item">Min: <span class="stat-value">${matrixStats.min}</span></div>
                <div class="stat-item">Max: <span class="stat-value">${matrixStats.max}</span></div>
                <div class="stat-item">Det: <span class="stat-value">${matrixStats.determinant}</span></div>
                <div class="stat-item">Rank: <span class="stat-value">${calculateRank()}</span></div>
            `;
        }

        function calculateRank() {
            // Simplified rank calculation
            return Math.min(currentMatrix.length, currentMatrix[0]?.length || 0);
        }

        // Export functions
        function copyMatrix() {
            const matrixText = currentMatrix.map(row => row.join('\t')).join('\n');
            navigator.clipboard.writeText(matrixText).then(() => {
                showNotification('Matrix copied to clipboard', 'success');
            }).catch(() => {
                showNotification('Failed to copy matrix', 'error');
            });
        }

        function exportCSV() {
            const csv = currentMatrix.map(row => row.join(',')).join('\n');
            downloadFile(csv, 'matrix.csv', 'text/csv');
            showNotification('Matrix exported as CSV', 'success');
        }

        function exportText() {
            const text = currentMatrix.map(row => 
                '[' + row.map(val => val.toString().padStart(8)).join(',') + ']'
            ).join('\n');
            downloadFile(text, 'matrix.txt', 'text/plain');
            showNotification('Matrix exported as text', 'success');
        }

        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Utility functions
        function updateMatrixInfo(rows, cols, type) {
            document.getElementById('matrix-size').textContent = `${rows}×${cols} Matrix`;
            document.getElementById('matrix-type').textContent = type;
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            // Style the notification
            Object.assign(notification.style, {
                position: 'fixed',
                top: '20px',
                right: '20px',
                padding: '12px 16px',
                borderRadius: 'var(--radius)',
                color: 'white',
                fontWeight: '500',
                zIndex: '9999',
                transform: 'translateX(100%)',
                transition: 'transform 0.3s ease-in-out',
                maxWidth: '300px'
            });

            // Set background color based on type
            const colors = {
                success: 'var(--success)',
                error: 'var(--error)',
                warning: 'var(--warning)',
                info: 'var(--primary)'
            };
            notification.style.background = colors[type] || colors.info;

            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);

            // Animate out and remove
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Accessibility enhancements
        function setupAccessibility() {
            // Add ARIA labels and roles
            document.querySelectorAll('.btn').forEach(btn => {
                if (!btn.getAttribute('aria-label')) {
                    btn.setAttribute('aria-label', btn.textContent.trim());
                }
            });

            // Add keyboard navigation for matrix cells
            document.addEventListener('keydown', function(e) {
                const activeElement = document.activeElement;
                if (activeElement.classList.contains('matrix-cell')) {
                    const row = parseInt(activeElement.dataset.row);
                    const col = parseInt(activeElement.dataset.col);
                    let newRow = row, newCol = col;

                    switch(e.key) {
                        case 'ArrowUp':
                            newRow = Math.max(0, row - 1);
                            break;
                        case 'ArrowDown':
                            newRow = Math.min(currentMatrix.length - 1, row + 1);
                            break;
                        case 'ArrowLeft':
                            newCol = Math.max(0, col - 1);
                            break;
                        case 'ArrowRight':
                            newCol = Math.min(currentMatrix[0].length - 1, col + 1);
                            break;
                    }

                    const newCell = document.querySelector(`[data-row="${newRow}"][data-col="${newCol}"]`);
                    if (newCell) {
                        newCell.focus();
                        e.preventDefault();
                    }
                }
            });
        }

        // Initialize accessibility features
        setTimeout(setupAccessibility, 100);
    </script>
</body>
</html>